# Отчет по лабораторной работе №5

## SAST-анализ

1. Произвести запуск приложения, выполненного на языке программирования Python (см. приложения к файлу)
<img width="1351" height="924" alt="image" src="https://github.com/user-attachments/assets/c9fb3085-ec4a-45ad-a1d8-d739ad488385" /><br><br>


2. Подготовьте инструменты для SAST анализа
Bandit (для Python) или аналоги Semgrep или SonarQube:<br>

установил Bandit командой: "pip install bandit"<br><br>
запустил командой "bandit -r vulnerable_app.py -f html -o bandit_report.html" , где отчет выдан в формате html<br><br>
<img width="974" height="524" alt="image" src="https://github.com/user-attachments/assets/ac231027-fea8-43a3-8ab5-61e4be3b345b" />
<img width="974" height="528" alt="image" src="https://github.com/user-attachments/assets/4302173a-e4df-4fe2-b676-2099baf267fe" />
<img width="974" height="518" alt="image" src="https://github.com/user-attachments/assets/80d16d58-4857-42b0-925a-997f6764eaa5" />
<br><br>

установил semgrep командой: "pip install semgrep"<br><br>
Просканировал папку с приложением командой "semgrep --config=auto vulnerable_app.py"<br><br>
<img width="974" height="448" alt="image" src="https://github.com/user-attachments/assets/29d2f907-b005-4cb2-bf8e-353aff906cb9" />
<br><br>

Сравнительная таблица SAST-анализа
| Критерий | Bandit | Semgrep |
|----------|--------|---------|
| Обнаруженные SQL-инъекции | **Да** | Нет |
| Обнаруженные XSS-уязвимости | **Да** | **Да** |
| Время анализа | < 10 сек | < 10 сек |
| Полнота покрытия | Базовые проверки | Глубокий анализ шаблонов |
| Простота использования | Очень просто | Требует настройки правил |

<br><br>

## DAST-анализ
<br>
Установил flask командой "pip install flask"<br>
Создал файл vulnerable_app.py<br>
Запустил файл vulnerable_app.py<br>
Запустил zaproxy<br>
<img width="2159" height="1233" alt="image" src="https://github.com/user-attachments/assets/17adef78-16ca-49f4-860b-a95db1c1045c" />

<br>

Выявленные элементы<br>
<img width="2157" height="540" alt="image" src="https://github.com/user-attachments/assets/7742155b-2303-4b95-886f-e3707d100ece" />
<br>

### Результаты DAST-анализа (OWASP ZAP)

**Всего найдено уязвимостей:** 8 типов, 62 случая

#### Критические уязвимости:
1. **SQL Injection** (2 случая) - позволяет выполнять произвольные SQL-запросы
2. **Command Injection** (1 случай) - позволяет выполнять команды ОС
3. **Server-Side Template Injection** (2 случая) - инъекция в шаблоны

#### Уязвимости конфигурации:
4. **Отсутствие CSP** (15 случаев)
5. **Отсутствие защиты от кликджекинга** (12 случаев)
6. **Небезопасные cookies** (без SameSite)
7. **Отсутствие X-Content-Type-Options** (12 случаев)
8. **Утечка информации** (раскрытие версий)

**Вывод:** Приложение содержит критические уязвимости, требующие немедленного исправления.
<br>

вывод nikto<br>
<img width="2142" height="314" alt="image" src="https://github.com/user-attachments/assets/9ac70cf7-e43c-4b55-a4ce-316be8b01244" /><br>

<br><br>

### Триаж уязвимостей
<br>

Развернул Metasplotable2<br>
<img width="727" height="403" alt="image" src="https://github.com/user-attachments/assets/aed36c81-799a-402a-b473-6d20e032a906" />
<br>

Провел сканирование всех портов через Nmap 7.95 + Vulners script на kali linux<br>
<img width="881" height="845" alt="image" src="https://github.com/user-attachments/assets/ccfeff42-a674-4be5-bffe-cfe33817372a" />
<br><br>

### Уязвимость 1: VSFTPD 2.3.4 Backdoor (CVE-2011-2523)
1. Сканер: Nmap с детекцией версий<br>
2. Название: Backdoor в vsftpd 2.3.4<br>
3. Тип: Истинная уязвимость<br>
4. Анализ:
   - Критичность: Critical (CVSS 10.0)<br>
   - Сетевая доступность: Интранет<br>
   - Ценность актива: FTP-сервер с конфиденциальными данными<br>
   - Сложность эксплуатации: Низкая (готовый эксплойт в Metasploit)<br>
   - Потенциальный ущерб:<br>
     * Финансовый:  Высокий<br>
     * Репутационный:  Критический<br>
     * Регуляторный:  Высокий<br>
5. Приоритет устранения: 1 (самый высокий)<br>
6. Меры:<br>
   - Краткосрочные: Блокировать порт 21, отключить vsftpd<br>
   - Долгосрочные: Обновить до актуальной версии, перейти на SFTP<br>
#

### Уязвимость 2: UnrealIRCd Backdoor (CVE-2010-2075)
2. Сканер: Nmap с детекцией версий<br>
3. Название: Backdoor в UnrealIRCd 3.2.8.1<br>
4. Тип: Истинная уязвимость<br>
5. Анализ:<br>
   - Критичность: Critical (CVSS 9.8)<br>
   - Сетевая доступность: Интранет<br>
   - Ценность актива: IRC-сервер для коммуникаций<br>
   - Сложность эксплуатации: Средняя<br>
   - Потенциальный ущерб:<br>
     * Финансовый:  Средний<br>
     * Репутационный:  Высокий<br>
     * Регуляторный:  Низкий<br>
6. Приоритет устранения: 2<br>
7. Меры:<br>
   - Краткосрочные: Остановить службу, заблокировать порты 6667,6697<br>
   - Долгосрочные: Удалить или обновить UnrealIRCd<br>
#

### Уязвимость 3: Samba usermap script (CVE-2007-2447)
2. Сканер: Nmap с детекцией версий<br>
3. Название: Уязвимость в скрипте usermap Samba 3.X<br>
4. Тип: Истинная уязвимость<br>
5. Анализ:<br>
   - Критичность: High (CVSS 9.3)<br>
   - Сетевая доступность: Интранет<br>
   - Ценность актива: Файловый сервер с бизнес-документами<br>
   - Сложность эксплуатации: Средняя<br>
   - Потенциальный ущерб:<br>
     * Финансовый:  Средний<br>
     * Репутационный:  Высокий<br>
     * Регуляторный:  Средний<br>
6. Приоритет устранения: 3<br>
7. Меры:<br>
   - Краткосрочные: Отключить анонимный доступ, настроить ACL<br>
   - Долгосрочные: Обновить Samba до актуальной версии<br>
#

### Уязвимость 4: Apache 2.2.8 Multiple Vulnerabilities
2. Сканер: Nmap с детекцией версий<br>
3. Название: Множественные уязвимости в Apache 2.2.8<br>
4. Тип: Истинная уязвимость<br>
5. Анализ:<br>
   - Критичность: Medium (CVSS 6.8)<br>
   - Сетевая доступность: Интранет<br>
   - Ценность актива: Веб-сервер с корпоративным порталом<br>
   - Сложность эксплуатации: Высокая<br>
   - Потенциальный ущерб:<br>
     * Финансовый:  Низкий<br>
     * Репутационный:  Средний<br>
     * Регуляторный:  Низкий<br>
6. Приоритет устранения: 4<br>
7. Меры:<br>
   - Краткосрочные: Настроить WAF, ограничить доступ<br>
   - Долгосрочные: Обновить Apache до версии 2.4.x<br>
#

### Уязвимость 5: SSH Weak Server Key
2. Сканер: Nmap с детекцией версий<br>
3. Название: Слабые SSH ключи (Debian OpenSSL)<br>
4. Тип: Информационное сообщение<br>
5. Анализ:<br>
   - Критичность: Low (CVSS 3.7)<br>
   - Сетевая доступность: Интранет<br>
   - Ценность актива: Удалённый доступ к системе<br>
   - Сложность эксплуатации: Очень высокая<br>
   - Потенциальный ущерб:<br>
     * Финансовый:  Низкий<br>
     * Репутационный:  Низкий<br>
     * Регуляторный:  Низкий<br>
6. Приоритет устранения: 5 (самый низкий)<br>
7. Меры:<br>
   - Краткосрочные: Настроить fail2ban, мониторинг<br>
   - Долгосрочные: Сгенерировать новые SSH ключи<br>

#  Приоритизация уязвимостей

| Приоритет | Уязвимость | CVSS | Обоснование |
|:---:|:---|:---:|:---|
| **1** | **VSFTPD 2.3.4 Backdoor** (CVE-2011-2523) |  10.0 | Backdoor, RCE без аутентификации, немедленная угроза полной компрометации |
| **2** | **UnrealIRCd Backdoor** (CVE-2010-2075) |  9.8 | Backdoor, удалённое выполнение кода через IRC-сервер |
| **3** | **Samba usermap script** (CVE-2007-2447) |  9.3 | RCE через сетевой доступ к файловому серверу Samba |
| **4** | **Apache 2.2.8 Multiple Vulnerabilities** |  6.8 | Устаревшая версия с множеством известных уязвимостей |
| **5** | **SSH Weak Keys** (Debian OpenSSL) |  3.7 | Информационное сообщение, теоретически низкий риск |

#

##  Сравнение SAST и DAST подходов

| Критерий | SAST (Статический анализ) | DAST (Динамический анализ) |
|----------|---------------------------|----------------------------|
| **Обнаруженные SQL-инъекции** | **Bandit:** Да<br>**Semgrep:** Нет | **Да (2 инцидента)**<br>• SQL Injection обнаружены в веб-формах |
| **Обнаруженные XSS-уязвимости** | **Bandit:** Да<br>**Semgrep:** Да | **Да (косвенно)**<br>• Отсутствие CSP заголовка (18)<br>• Отсутствие X-Content-Type-Options (16) |
| **Ложные срабатывания** | **Bandit:** Средние<br>**Semgrep:** Низкие (с настройкой) | **Средние**<br>• Часть оповещений — информационные<br>• "Сервер утечка информации" (21) — низкий риск |
| **Время анализа** | **< 10 секунд**<br>• Bandit: быстро<br>• Semgrep: быстро | **1-5 минут**<br>• Зависит от количества страниц<br>• Полное сканирование веб-приложения |
| **Полнота покрытия** | **Bandit:** Базовые проверки Python<br>**Semgrep:** Глубокий анализ шаблонов | **Полная**<br>• 11 категорий уязвимостей<br>• От низкого до критического уровня |
| **Простота использования** | **Bandit:** Очень просто<br>**Semgrep:** Требует настройки правил | **Средняя**<br>• Требует настройки сканера<br>• Нужна интерпретация результатов |
| **Типы обнаруженных уязвимостей** | • SQLi<br>• XSS<br>• Потенциальные уязвимости кода | • SQL Injection (2)<br>• RCE<br>• SSTI<br>• Безопасность заголовков (70+ инцидентов)<br>• Информационная утечка |
| **Контекст обнаружения** | Исходный код приложения | Работающее веб-приложение, HTTP-ответы |
| **Примеры инструментов** | Bandit, Semgrep, SonarQube | OWASP ZAP, Burp Suite, Acunetix |


#


## Ответы на контрольные вопросы

### 1. В чем принципиальное отличие SAST от DAST?

SAST анализирует исходный код приложения без его запуска, выявляя уязвимости на этапе разработки. 
DAST тестирует работающее приложение, имитируя действия злоумышленника. 

### 2. Какие типы уязвимостей лучше обнаруживает SAST?

SAST эффективен для поиска уязвимостей в бизнес-логике, SQL-инъекций в коде, межсайтового скриптинга (XSS) в шаблонах, переполнения буфера, небезопасного использования криптографии и хранения секретов в коде.

### 3. Какие типы уязвимостей лучше обнаруживает DAST?

DAST лучше находит конфигурационные ошибки серверов, проблемы с HTTP-заголовками безопасности, уязвимости аутентификации и авторизации, сессионные уязвимости и информацию, раскрываемую сервером в ответах и ошибках.

### 4. Почему важно использовать оба метода в процессе разработки?

SAST позволяет находить и устранять уязвимости на ранних этапах разработки, что дешевле и эффективнее. DAST проверяет приложение в условиях, максимально приближенных к реальным. Вместе они обеспечивают комплексную проверку безопасности.

### 5. Какие ограничения имеют каждый из методов?

SAST часто выдает ложные срабатывания, не видит runtime-проблем и требует доступа к исходному коду. DAST нуждается в работающем приложении, может проверять только доступные эндпоинты и иногда мешает работе приложения.

### 6. Что такое AppSec?

AppSec (Application Security) — это набор практик, процессов и инструментов для обеспечения безопасности приложений на протяжении всего их жизненного цикла. Включает безопасную разработку, тестирование, обучение и реагирование на инциденты.

### 7. Что такое триаж уязвимостей и каковы его основные цели?

Триаж уязвимостей — это процесс оценки, классификации и приоритизации найденных уязвимостей. Основные цели: определение реальной критичности уязвимостей, эффективное распределение ресурсов на исправление и снижение информационного шума.

### 8. Чем простое сканирование на уязвимости отличается от полноценного процесса триажа?

Простое сканирование выдает автоматический отчет без анализа контекста. Триаж включает ручную оценку, валидацию находок, учет бизнес-контекста и принятие решений о приоритетах исправления.

### 9. Почему автоматический сканер не может полностью заменить человека в процессе триажа? Какие его ограничения компенсирует аналитик?

Автоматический сканер не понимает бизнес-контекст, не оценивает сложность эксплуатации в конкретной среде и не различает ложные срабатывания. Аналитик добавляет контекст, валидирует находки и принимает взвешенные решения на основе понимания рисков.

### 10. Почему важно документировать решение об отложении исправления уязвимости с низким приоритетом?

Документация обеспечивает трассируемость решений для аудита, демонстрирует осознанное управление рисками, защищает от обвинений в халатности и поддерживает прозрачность процесса безопасности.
